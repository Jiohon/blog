#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# ç‰ˆæœ¬æ›´æ–°
node scripts/bump-version.js
git add package.json

# ä»£ç æ ¡éªŒ
echo "ğŸ” å¼€å§‹ä»£ç æ ¡éªŒ..."

# ESLint æ£€æŸ¥
echo "ğŸ“‹ è¿è¡Œ ESLint æ£€æŸ¥..."
pnpm lint:check
if [ $? -ne 0 ]; then
  echo "âŒ ESLint æ£€æŸ¥å¤±è´¥ï¼Œè¯·ä¿®å¤ä»£ç é—®é¢˜åå†æäº¤"
  exit 1
fi

# Prettier æ ¼å¼æ£€æŸ¥
echo "ğŸ’„ è¿è¡Œ Prettier æ ¼å¼æ£€æŸ¥..."
pnpm format:check
if [ $? -ne 0 ]; then
  echo "âŒ ä»£ç æ ¼å¼æ£€æŸ¥å¤±è´¥ï¼Œè¯·è¿è¡Œ 'pnpm format' ä¿®å¤æ ¼å¼é—®é¢˜åå†æäº¤"
  exit 1
fi

# TypeScript ç±»å‹æ£€æŸ¥
echo "ğŸ”§ è¿è¡Œ TypeScript ç±»å‹æ£€æŸ¥..."
pnpm type-check
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript ç±»å‹æ£€æŸ¥å¤±è´¥ï¼Œè¯·ä¿®å¤ç±»å‹é”™è¯¯åå†æäº¤"
  exit 1
fi

echo "âœ… æ‰€æœ‰ä»£ç æ ¡éªŒé€šè¿‡ï¼"